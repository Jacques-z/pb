# manage-console-ui Specification

## Purpose
TBD - created by archiving change add-client-management-ui. Update Purpose after archive.
## Requirements
### Requirement: 管理控制台入口与权限提示
客户端 MUST 在同一桌面应用内提供管理控制台入口，包含班次、人员、用户、审计日志与账号设置等模块。
客户端 MUST 在未登录状态隐藏或禁用管理功能并提示需要登录。
客户端 MUST 仅在管理员身份下显示用户管理与审计日志模块，并在非管理员访问时提示权限不足。

#### Scenario: 非管理员访问管理模块
- **当** 普通用户登录后尝试进入用户管理或审计日志模块
- **则** 客户端隐藏或禁用该入口并提示权限不足

### Requirement: 班次管理界面
客户端 MUST 提供班次列表与新建/编辑/删除操作，并调用对应班次 API。
客户端 MUST 在操作成功后刷新列表并显示最新结果。
客户端 MUST 提供人员选择（来源于人员目录）与 start_at/end_at 输入。

#### Scenario: 创建班次
- **当** 已认证用户提交有效班次表单
- **则** 客户端调用创建接口并在列表中显示新班次

### Requirement: 人员目录查看
客户端 MUST 提供只读人员目录列表并显示姓名与 id。
客户端 MUST 支持手动刷新人员列表。

#### Scenario: 查看人员目录
- **当** 已认证用户打开人员目录
- **则** 客户端显示人员列表并允许刷新

### Requirement: 用户管理界面
客户端 MUST 为管理员提供用户列表与创建/更新/删除/重置密码操作，并调用用户管理 API。
客户端 MUST 在创建或重置密码时使用用户名作盐生成 password_client_hash。
客户端 MUST 在删除失败（例如 409）时显示明确错误提示。

#### Scenario: 管理员创建用户
- **当** 管理员提交用户名、姓名与密码
- **则** 客户端生成 password_client_hash 并调用创建用户接口

### Requirement: 账号自助操作
客户端 MUST 提供已登录用户的修改密码入口，并调用 /auth/change-password。
客户端 MUST 在修改密码成功后清除本地令牌并要求重新登录。
客户端 MUST 提供退出登录入口并清除本地会话。

#### Scenario: 修改密码后重新登录
- **当** 已认证用户成功修改密码
- **则** 客户端清除本地令牌并引导重新登录

### Requirement: 审计日志查看界面
客户端 MUST 为管理员提供审计日志只读列表，并调用审计日志查询接口。
客户端 MUST 按 occurred_at 倒序显示日志并支持手动刷新。

#### Scenario: 管理员查看审计日志
- **当** 管理员进入审计日志页面
- **则** 客户端展示最新日志列表并可刷新

### Requirement: 日历排班视图
客户端 MUST 在班次管理中提供日/周/月视图切换。
客户端 MUST 默认展示全部人员的班次，并提供人员筛选开关以控制显示范围。
客户端 MUST 在月视图中以只读方式展示班次，不允许创建或调整。
客户端 MUST 在过去时间段内以只读方式展示班次，不允许创建或调整。

#### Scenario: 切换视图模式
- **当** 用户在班次管理中切换日/周/月视图
- **则** 客户端按对应视图展示班次分布

#### Scenario: 过去时间段只读
- **当** 用户查看过去时间段的班次
- **则** 班次条仅展示不可编辑

### Requirement: 日历交互创建与调整
客户端 MUST 提供“新建”按钮生成可视化班次草稿条。
客户端 MUST 在草稿条上显示左右端点并允许拖动以调整起止时间。
客户端 MUST 在草稿条旁显示人员选择浮层，并支持鼠标滚轮切换人员。
客户端 MUST 在日/周视图支持保存草稿并调用班次创建接口。
客户端 MUST 在日/周视图支持拖动端点调整已存在班次并调用班次更新接口。
客户端 MUST NOT 支持拖动整体移动班次条。

#### Scenario: 新建草稿条
- **当** 用户点击新建按钮
- **则** 客户端生成草稿条并显示可拖动端点与人员选择浮层

#### Scenario: 端点拖动调整
- **当** 用户在日/周视图拖动班次条端点
- **则** 客户端更新起止时间并允许保存修改

